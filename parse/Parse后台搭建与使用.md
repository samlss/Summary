# Parseåå°æ­å»ºä¸ä½¿ç”¨

## ä»€ä¹ˆæ˜¯Parseï¼Ÿ

å®˜ç½‘ï¼šhttps://docs.parseplatform.org/

Githubï¼šhttps://github.com/parse-community

- Parseæ˜¯ä¸€ä¸ªç§»åŠ¨åç«¯ï¼Œæœ€åˆç”±æä¾›å•†Parse Incå¼€å‘ã€‚è¯¥å…¬å¸äº2013å¹´è¢«Facebookæ”¶è´­ï¼Œå¹¶äº2017å¹´1æœˆå…³é—­ã€‚ç»§2016å¹´å®£å¸ƒå³å°†å…³é—­åï¼Œè¯¥å¹³å°éšåå¼€æºã€‚ ç”±äºæ‰˜ç®¡æœåŠ¡è¢«å…³é—­ï¼ŒParse Platformå·²ç»å‘å±•æˆä¸ºä¸€ä¸ªå¼€æºç¤¾åŒºï¼Œæ‹¥æœ‰è‡ªå·±çš„åšå®¢ï¼Œæ–‡æ¡£å’Œç¤¾åŒºè®ºå›ã€‚

- Parseæ˜¯ä¸€ä¸ªåŸºäºäº‘ç«¯çš„åç«¯ç®¡ç†å¹³å°ã€‚å¯¹äºå¼€å‘è€…è€Œè¨€ï¼ŒParseæä¾›åç«¯çš„ä¸€ç«™å¼å’Œä¸€æ½å­æœåŠ¡ï¼šæœåŠ¡å™¨é…ç½®ã€æ•°æ®åº“ç®¡ç†ã€APIã€å½±éŸ³æ–‡ä»¶å­˜å‚¨ï¼Œå®æ—¶æ¶ˆæ¯æ¨é€ã€å®¢æˆ·æ•°æ®åˆ†æç»Ÿè®¡ã€ç­‰ç­‰ã€‚è¿™æ ·ï¼Œå¼€å‘è€…åªéœ€è¦å¤„ç†å¥½å‰ç«¯/å®¢æˆ·ç«¯/æ‰‹æœºç«¯çš„å¼€å‘ï¼Œå°†åç«¯æ”¾å¿ƒçš„äº¤ç»™Parseå³å¯ã€‚ç›®å‰Parseæ”¯æŒè¶…è¿‡50ä¸‡ä¸ªAppã€‚[æ‘˜è‡ªæµ…è°ˆ Parse](https://www.jianshu.com/p/d92c5b2380ea)
- Parseå¯ä»¥è®©ä¸€ä¸ªä½œä¸ºAndroid/IOSå¼€å‘çš„ä½ ï¼Œä¸ç”¨åå°å¼€å‘äººå‘˜é…åˆå°±å¯ä»¥å¤„ç†åå°æ•°æ®ï¼Œå¹¶ä¸”å…¶æœ‰ä¸“é—¨çš„ç”¨æˆ·ç³»ç»Ÿï¼Œæ¶ˆæ¯æ¨é€åŠŸåŠŸèƒ½ç­‰ç­‰ï¼Œè€Œä¸”APIç®€å•æ˜“ç”¨ï¼Œè™½ç„¶å‘è¿˜æ˜¯æœ‰ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸€ä¸ªå¾ˆå€¼å¾—Androidå¼€å‘è€…å…¥æ‰‹çš„ä¸€ä¸ªæ¡†æ¶ã€‚

Parseç›®å‰æ”¯æŒä»¥ä¸‹å¹³å°è¯­è¨€ï¼š

![snap_parse_support](https://github.com/samlss/Summary/blob/master/parse/snap_parse_support.png)



## æœåŠ¡å™¨æ­å»º

### ç¯å¢ƒ

- æœ¬äººæœåŠ¡å™¨ä¸ºé˜¿é‡Œäº‘CentOs7.4ç³»ç»ŸæœåŠ¡å™¨
- XShell6

è¿™ç¯‡æ–‡ç« ä»…è®°å½•Parseåå°æ­å»ºä¸åœ¨Androidä¸­çš„ä½¿ç”¨ï¼Œæ›´è¯¦ç»†çš„ä½¿ç”¨ä»‹ç»å¦‚æœåé¢æœ‰æ—¶é—´è¿˜ä¼šæ€»ç»“

**é¦–å…ˆåœ¨rootä¸‹åˆ›å»ºparseç›®å½•ï¼Œç„¶åè¿›å…¥åˆ°parseç›®å½•**

## å®‰è£…nodejs

```shell
wget https://npm.taobao.org/mirrors/node/v12.0.0/node-v12.0.0-linux-x64.tar.xz
```

ç‰ˆæœ¬çœ‹ä½ éœ€è¦ä»€ä¹ˆç‰ˆæœ¬ï¼Œå»ºè®®8.0.0ä»¥ä¸Šï¼ŒParseåå°éœ€è¦Node4.3ä»¥ä¸Šç‰ˆæœ¬

ä¸‹è½½å®Œæˆåå¯ä»¥çœ‹åˆ°ï¼š

![snap_wget_node](https://github.com/samlss/Summary/blob/master/parse/snap_wget_node.png)

è§£å‹

```shell
tar -xvf node-v12.0.0-linux-x64.tar.xz
```

è§£å‹åå¯ä»¥çœ‹åˆ°ï¼š

![snap_unzip_node](https://github.com/samlss/Summary/blob/master/parse/snap_unzip_node.png)

å°†åŸæœ¬å‹ç¼©æ–‡ä»¶åˆ é™¤

```shell
rm node-v12.0.0-linux-x64.tar.xz  -f
```

å°†node-v12.0.0-linux-x64æ–‡ä»¶å¤¹é‡æ–°å‘½åä¸ºnode:

```shell
mv node-v12.0.0-linux-x64/ node
```

ç°åœ¨è¯¥ç›®å½•ä¸‹ä¸ºï¼š

![snap_rename_node](https://github.com/samlss/Summary/blob/master/parse/snap_rename_node.png)

è¿›å…¥åˆ°nodeçš„binç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†nodeå’Œnpmè®¾ç½®ä¸ºå…¨å±€å‘½ä»¤:

```shell
ln -s /root/parse/node/bin/node  /usr/local/bin/node
ln -s /root/parse/node/bin/npm  /usr/local/bin/npm
```

æˆ‘ä»¬ æŸ¥çœ‹ /usr/locl/binç›®å½•å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸäº†ï¼š

![snap_node_ln](https://github.com/samlss/Summary/blob/master/parse/snap_node_ln.png)

æ¥ç€æˆ‘ä»¬å¯ä»¥åœ¨ç»ˆç«¯ä»»ä½•åœ°æ–¹é€šè¿‡npmå‘½ä»¤ä¸‹è½½ç›¸å…³çš„å†…å®¹äº†

## å®‰è£…MongoDB

parseæœåŠ¡å™¨åå°éœ€è¦æ­é…MongoDBï¼Œä¸”ç‰ˆæœ¬è¦æ±‚ä¸º2.6.Xï¼Œ3.0.Xï¼Œ3.2.X

**æˆ‘ä»¬å®‰è£…3.2.4ç‰ˆæœ¬**

é¦–å…ˆåœ¨parseç›®å½•ä¸‹åˆ›å»ºmongodbç›®å½•ï¼Œç°åœ¨/root/parseç›®å½•å°±æœ‰ä¸¤ä¸ªç›®å½•äº†ï¼š

![snap_parse_dirs](https://github.com/samlss/Summary/blob/master/parse/snap_parse_dirs.png)

è¿›å…¥mongodbç›®å½•ï¼Œè¾“å…¥ä¸‹è½½å‘½ä»¤ä¸‹è½½å‹ç¼©åŒ…ï¼š

```shell
wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-3.2.4.tgz
```

ä¸‹è½½å®Œæˆåè§£å‹ï¼š

```
tar -xvf mongodb-linux-x86_64-rhel70-3.2.4.tgz
```

è§£å‹å®Œæˆååˆ é™¤å‹ç¼©åŒ…ï¼š

```shell
rm mongodb-linux-x86_64-rhel70-3.2.4.tgz -f
```



ç°åœ¨ç›®å½•ä¸ºï¼š

![snap_mongodb_dir](https://github.com/samlss/Summary/blob/master/parse/snap_mongodb_dir.png)

å†æ‰§è¡Œå‘½ä»¤å°†mongodb-linux-x86_64-rhel70-3.2.4ç›®å½•æ‰€æœ‰ä¸œè¥¿å‰ªåˆ‡åˆ°mongodbç›®å½•ï¼š

```shell
mv mongodb-linux-x86_64-rhel70-3.2.4/* ./
rm mongodb-linux-x86_64-rhel70-3.2.4/ -rf
```

æœ€åmongodbç›®å½•ä¸‹ä¸ºï¼š

![snap_mv_mogodb_dir](https://github.com/samlss/Summary/blob/master/parse/snap_mv_mogodb_dir.png)

åœ¨mongodbç›®å½•åˆ›å»ºä¸€ä¸ªç›®å½•dataï¼š

```shell
mkdir data
cd data  //è¿›å…¥dataç›®å½•

//åˆ›å»ºä¸¤ä¸ªç›®å½•
mkdir db //å­˜æ”¾æ•°æ®æ–‡ä»¶
mkdir logs //å­˜æ”¾æ—¥å¿—æ–‡ä»¶
```

å†è¿›å…¥åˆ°mongodbçš„binç›®å½•ï¼Œå¯ä»¥çœ‹åˆ°è¯¥ç›®å½•ä¸‹æœ‰ä»¥ä¸‹å‘½ä»¤æ–‡ä»¶ï¼š

![snap_mongodb_bin](https://github.com/samlss/Summary/blob/master/parse/snap_mongodb_bin.png)

è¿›å…¥åˆ°parse-server/binç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†mongoè®¾ç½®ä¸ºå…¨å±€å‘½ä»¤ï¼š

```
ln -s /root/parse/mongodb/bin/mongo /usr/local/bin/mongo
```

åœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªmongodbçš„é…ç½®æ–‡ä»¶(æ€ä¹ˆåˆ›å»ºæ–‡ä»¶ä¸ç”¨è¯´äº†å§ğŸ˜‰):

```shell
dbpath = /root/parse/mongodb/data/db
logpath = /root/parse/mongodb/data/logs/mongodb.log
port = 27017
fork = true
logappend=true
```

- dbpathï¼šè®¾ç½®æ•°æ®æ–‡ä»¶å­˜æ”¾ç›®å½•
- logpathï¼šè®¾ç½®æ—¥å¿—æ–‡ä»¶çš„å­˜æ”¾ç›®å½•åŠå…¶æ—¥å¿—æ–‡ä»¶å 
- portï¼šè®¾ç½®ç«¯å£å·ï¼ˆé»˜è®¤ä¸º27017ï¼‰
- forkï¼šè®¾ç½®ä¸ºä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå³åœ¨åå°è¿è¡Œ 
- logappendï¼šå¼€å¯æ—¥å¿—è¿½åŠ æ·»åŠ æ—¥å¿—

å¯åŠ¨mongodb

```shell
./mongod --config mongodb.conf 

//ä¸‹é¢ä¸ºæˆåŠŸåçš„è¿”å›
[root@izj6c0bdyow5dsyv3ptlfez bin]# ./mongod --config mongodb.conf 
about to fork child process, waiting until server is ready for connections.
forked process: 1696
child process started successfully, parent exiting
```

è¾“å…¥å‘½ä»¤æŸ¥çœ‹ç«¯å£ï¼š

```shell
netstat -tunpl
```

å¯ä»¥çœ‹åˆ°mongodbå·²ç»å¯åŠ¨ä¸”åœ¨ç›‘å¬27017ç«¯å£ï¼š

![snap_mongodb_start](https://github.com/samlss/Summary/blob/master/parse/snap_mongodb_start.png)

æœ€ååœ¨æµè§ˆå™¨è¾“å…¥ï¼š

```js
http://{ä½ çš„æœåŠ¡å™¨ip}:27017/
```



å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

![snap_mongodb_connect](https://github.com/samlss/Summary/blob/master/parse/snap_mongodb_connect.png)

**æ³¨æ„ï¼š**å¦‚æœä½ ç”¨çš„æœåŠ¡å™¨éœ€è¦é…ç½®ç½‘ç»œå®‰å…¨ç»„çš„è¯ï¼Œè¯·åˆ°æ·»åŠ ä¸€ä¸ª27017ç«¯å£çš„ç½‘ç»œå®‰å…¨ç»„ï¼Œå¦åˆ™è¯¥ç«¯å£æ²¡æœ‰è®¿é—®æƒé™ã€‚ä¸”æµ‹è¯•å®Œä¹‹åæœ€å¥½å…³é—­è¯¥ç«¯å£çš„å¤–ç½‘è®¿é—®æƒé™ï¼Œå¦åˆ™ç«¯å£æœ‰å¯èƒ½è¢«æ”»å‡»ã€‚æ›¾ç»æœ¬äººå›¢é˜Ÿç”±äºæœåŠ¡å™¨å¼€å¯äº†27017ç«¯å£çš„å¤–ç½‘è®¿é—®æƒé™ï¼Œå¯¼è‡´æ•°æ®åº“è¢«é»‘ï¼Œè¦ç»™é»‘å®¢é’±æ‰èƒ½æ‹¿å›æ—§æ•°æ®ï¼Œæ‰€å¹¸å½“æ—¶å¤„äºæµ‹è¯•é˜¶æ®µï¼Œé€ æˆä¸äº†ä»€ä¹ˆæŸå¤±ã€‚

## å®‰è£…Parseåå°

å¯åœ¨ä»»ä½•ç›®å½•ä¸‹æ‰§è¡Œå®‰è£…parse-serverå‘½ä»¤ï¼š

```shell
npm install -g parse-server
```

æœ€åä¼šä¸‹è½½åœ¨/root/parse/node/lib/node_modulesç›®å½•ä¸‹ï¼š

![snap_parse_server_install](https://github.com/samlss/Summary/blob/master/parse/snap_parse_server_install.png)

è¿›å…¥åˆ°parse-server/binç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†parse-serverè®¾ç½®ä¸ºå…¨å±€å‘½ä»¤ï¼š

```shell
ln -s /root/parse/node/lib/node_modules/parse-server/bin/parse-server /usr/local/bin/parse-server
```

ç„¶åå¯åŠ¨parseåå°æœåŠ¡ï¼š

```shell
parse-server --appId APPLICATION_ID --masterKey MASTER_KEY --databaseURI mongodb://localhost/parse &
```

- mongodb://localhost/parse é…ç½®åœ¨mongodbçš„parseæ•°æ®åº“ä¸‹
- & ä»£è¡¨è®©parse-serveråœ¨åå°è¿è¡Œï¼Œä¸é˜»å¡å½“å‰ç»ˆç«¯

æ‰§è¡ŒæˆåŠŸåå¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š

![snap_parse_server_start_success](https://github.com/samlss/Summary/blob/master/parse/snap_parse_server_start_success.png)

æˆ‘ä»¬å¯ä»¥æ‰§è¡Œmongoå‘½ä»¤æŸ¥çœ‹æ•°æ®åº“ï¼š

```
mongo
> show dbs
```



![snap_mongodb_parse_db](https://github.com/samlss/Summary/blob/master/parse/snap_mongodb_parse_db.png)



## å®‰è£…Parseç®¡ç†é¢æ¿

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ç®¡ç†é¢æ¿

```shell
npm install -g parse-dashboard
```

ä¼šä¸‹è½½åœ¨/root/parse/node/lib/node_modulesç›®å½•ä¸‹ï¼š

![snap_parse_dashboard_download](https://github.com/samlss/Summary/blob/master/parse/snap_parse_dashboard_download.png)

è¿›å…¥åˆ°parse-dashboard/binç›®å½•ï¼Œåˆ›å»ºé…ç½®æ–‡ä»¶parse-dashboard.conf(å¯éšä¾¿å‘½å)ï¼š

```shell
{
  "apps": [
    {
      "serverURL": "http://localhost:1337/parse",
      "appId": "myappid",
      "masterKey": "myappkey",
      "appName": "MyApp"
    }
  ],
  "users": [
    {
      "user":"admin",
      "pass":"admin"
    }
  ]
}
```

- serverURLï¼šparseæœåŠ¡å™¨åœ°å€
- appidï¼šä½ çš„åº”ç”¨id
- masterKeyï¼šä½ çš„åº”ç”¨çš„masterKey
- appNameï¼šåº”ç”¨åç§°
- usersï¼šç®¡ç†é¢æ¿çš„ç™»å½•è´¦å·

å…³äºé…ç½®æ–‡ä»¶ï¼Œç›®å‰ä¸Šé¢ä¾‹å­åªæ˜¯ä¸€ä¸ªæœ€ç®€å•çš„å•ä¸ªappç®¡ç†é¢æ¿ï¼Œæ›´å¤šç›¸å…³é…ç½®å¯ä»¥çœ‹ï¼šhttps://github.com/parse-community/parse-dashboard

å¯åŠ¨parse-dashboardæœåŠ¡ï¼š

```
./parse-dashboard --config parse-dashboard.conf --allowInsecureHTTP &
```

- allowInsecureHTTPï¼šå…è®¸è¿œç¨‹è®¿é—®httpåè®®çš„ç®¡ç†é¢æ¿
- & åå°å¯åŠ¨ï¼Œä¸é˜»å¡å½“å‰ç»ˆç«¯è¿›ç¨‹

æˆåŠŸåä¼šæç¤ºï¼š

```shell
ln -s /root/parse/node/lib/node_modules/parse-dashboard/bin/parse-dashboard /usr/local/bin/parse-dashboard
```

![snap_parse_dashboard_start_success](https://github.com/samlss/Summary/blob/master/parse/snap_parse_dashboard_start_success.png)

é˜¿é‡Œäº‘è¿™è¾¹éœ€è¦å¼€å¯å®‰å…¨ç»„å…è®¸å¤–ç½‘4040ç«¯å£ï¼š

![snap_safety_port](https://github.com/samlss/Summary/blob/master/parse/snap_safety_port.png)



æœ€åï¼Œåœ¨æµè§ˆå™¨è¾“å…¥

```javascript
http://{ä½ çš„æœåŠ¡å™¨ip}:4040/
```



å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹è¯æ˜é…ç½®æˆåŠŸï¼š

![snap_parse_dashboard_login](https://github.com/samlss/Summary/blob/master/parse/snap_parse_dashboard_login.png)

![snap_parse_dash_board_details](https://github.com/samlss/Summary/blob/master/parse/snap_parse_dash_board_details.png)

## å®‰è£…æ€»ç»“

ä¸»è¦éœ€è¦å››æ­¥:

1. å®‰è£…nodejs
2. å®‰è£…mongodb
3. å®‰è£…parse-server
4. å®‰è£…pase-dashboard



## ä½¿ç”¨é—®é¢˜

æˆ‘ä»¬åœ¨ç»ˆç«¯è°ƒç”¨å‘½ä»¤ï¼š

```shell
parse-server ... //å¯åŠ¨parseæœåŠ¡
parse-dashboard ... //å¯åŠ¨ç®¡ç†é¢æ¿æœåŠ¡
```

å¯åŠ¨parseæœåŠ¡å’Œç®¡ç†é¢æ¿æœåŠ¡åï¼Œä¸€æ—¦å…³é—­ç»ˆç«¯ï¼Œæˆ‘è¿™é‡Œæ˜¯å…³é—­XShell6ï¼Œå†è¾“å…¥ç®¡ç†é¢æ¿çš„ip+ç«¯å£ä¼šå‘ç°æ— æ³•è®¿é—®ï¼Œé‡æ–°è¿æ¥XShellä¼šå‘ç°parse-serverè¿›ç¨‹å’Œparse-dashboardè¿›ç¨‹éƒ½è¢«æ€æ‰äº†ã€‚åé¢å‘ç°ï¼Œä»…ä»…é€šè¿‡&æ— æ³•ä¿è¯åœ¨ç»ˆç«¯ä¸­åˆ›å»ºçš„è¿›ç¨‹ä¸è¢«æ€æ‰ï¼Œå¯ä»¥é€šè¿‡&+()æ–¹å¼ï¼Œæˆ–è€…setsidå°†å‘½ä»¤æäº¤åä¸å—æœ¬åœ°ç»ˆç«¯å…³é—­å½±å“ã€‚

[Linux æŠ€å·§ï¼šè®©è¿›ç¨‹åœ¨åå°å¯é è¿è¡Œçš„å‡ ç§æ–¹æ³•](https://www.ibm.com/developerworks/cn/linux/l-cn-nohup/)

## Androidç«¯ä»£ç 

åœ¨root build.gradleæ–‡ä»¶æ·»åŠ ï¼š

```java
allprojects {
	repositories {
		...
		maven { url "https://jitpack.io" }
	}
}
```

åœ¨ä½ é¡¹ç›®ä¾‹å¦‚appä¸‹çš„build.gradleæ·»åŠ ï¼š

```java
dependencies {
    implementation "com.github.parse-community.Parse-SDK-Android:parse:1.20.0"
}
```

åˆ›å»ºä¸€ä¸ªç”¨æˆ·ç±»ï¼š

```java
@ParseClassName("user")
public class UserObject extends ParseObject {
    public static String USER_ID = "user_id";
    public static String USER_NAME = "user_name";

    public void setUserId(String userId){
        if (userId != null){
            put(USER_ID, userId);
        }
    }

    public String getUserId() {
        return getString(USER_ID);
    }

    public void setUserName(String userName) {
        if (userName != null){
            put(USER_NAME, userName);
        }
    }

    public String getUserName() {
        return getString(USER_NAME);
    }
}
```

- ParseClassNameæ³¨é‡Šï¼šç±»ä¼¼äºæ•°æ®åº“ä¸­çš„è¡¨åï¼Œæ•°æ®åº“ä¸­ä¼šæœ‰ä¸€ä¸ªç±»ä¸å½“å‰ç±»åŒ¹é…

åˆå§‹åŒ–ï¼š

```java
ParseObject.registerSubclass(UserObject.class);
Parse.initialize(new Parse.Configuration.Builder(this)
      .applicationId("YOUR_APP_ID")
      // if defined
      .clientKey("YOUR_CLIENT_KEY")
      .server("http://{YOUR_SERVER_IP}:1337/parse/")
      .build()
    );
```

- ParseObject.registerSubclassï¼šè¯¥ç±»åªæœ‰ç»è¿‡æ³¨å†Œäº†æ‰èƒ½ä½¿ç”¨ï¼Œä¼šè”ç³»parseæ•°æ®åº“çš„userç±»

æ’å…¥æ•°æ®ï¼š

```java
UserObject userObject = new UserObject();
userObject.setUserId("10000");
userObject.setUserName("SamLeung");
userObject.saveInBackground(new SaveCallback() {
    @Override
    public void done(ParseException e) {
        Log.e("TAG", "save user done: " + e != null ? "success" : e.getMessage());
    }
});
```

- eä¸ºnullåˆ™ä»£è¡¨æ— å¼‚å¸¸ï¼Œä¿å­˜æˆåŠŸ
- eä¸ä¸ºnullåˆ™ä»£è¡¨å¼‚å¸¸ï¼Œä¿å­˜å¤±è´¥

æ‰§è¡Œåå¯ä»¥åœ¨DashBoardä¸­çœ‹åˆ°ä¿å­˜çš„å†…å®¹ï¼š

![snap_android_sdk_save_success](https://github.com/samlss/Summary/blob/master/parse/snap_android_sdk_save_success.png)



æ›´å¤šAndroidç«¯APIå¯å‚è€ƒï¼šhttps://docs.parseplatform.org/android/guide/